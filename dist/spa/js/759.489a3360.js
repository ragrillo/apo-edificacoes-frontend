"use strict";(globalThis["webpackChunkapo_edificacoes_client"]=globalThis["webpackChunkapo_edificacoes_client"]||[]).push([[759],{9759:(e,o,a)=>{a.r(o),a.d(o,{default:()=>C});var i=a(9835),t=a(6970);const r={class:"q-my-md text-bold text-uppercase"};function s(e,o,a,s,n,l){const c=(0,i.up)("q-linear-progress"),u=(0,i.up)("q-card-title"),d=(0,i.up)("q-card-section"),m=(0,i.up)("q-separator"),p=(0,i.up)("QuestionarioComponent"),g=(0,i.up)("q-btn"),h=(0,i.up)("q-card-actions"),f=(0,i.up)("q-card");return(0,i.wg)(),(0,i.j4)(f,{class:"q-ma-lg"},{default:(0,i.w5)((()=>[n.isLoading?((0,i.wg)(),(0,i.j4)(c,{key:0,indeterminate:"",color:"primary"})):(0,i.kq)("",!0),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,{class:"text-h6"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,t.zw)(n.nomeDimensao),1)])),_:1})])),_:1}),(0,i.Wm)(m),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.prepareQuestionario(),((e,o)=>((0,i.wg)(),(0,i.iD)("div",{key:o},[(0,i._)("div",r,(0,t.zw)(e.categoria),1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.perguntas,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.codigo},[(0,i.Wm)(p,{criterio:e,onResposta:l.addResposta},null,8,["criterio","onResposta"])])))),128))])))),128))])),_:1}),(0,i.Wm)(m),(0,i.Wm)(h,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{flat:"",color:"primary",label:"Fechar",to:"/ambiente"}),(0,i.Wm)(g,{flat:"",color:"primary",label:"Anterior",onClick:o[0]||(o[0]=e=>l.irParaAnterior())}),(0,i.Wm)(g,{flat:"",color:"primary",label:"Próximo",onClick:o[1]||(o[1]=e=>l.irParaProximo())}),(0,i.Wm)(g,{flat:"",color:"primary",label:n.hasSubmitted?"Salvo":"Salvar",disable:n.hasSubmitted,onClick:o[2]||(o[2]=e=>l.enviarFormulario())},null,8,["label","disable"])])),_:1})])),_:1})}a(6727),a(9665);var n=a(4136);const l={class:"q-my-sm"},c={class:"text-bold q-mb-md"};function u(e,o,a,r,s,n){const u=(0,i.up)("q-btn"),d=(0,i.up)("q-radio"),m=(0,i.up)("q-card-section"),p=(0,i.up)("q-card-actions"),g=(0,i.up)("q-card"),h=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",l,[a.criterio.dica?((0,i.wg)(),(0,i.j4)(u,{key:0,dense:"",rounded:"",flat:"",icon:"info",color:"primary",size:"sm",onClick:o[0]||(o[0]=e=>n.showDica(!0,a.criterio.enunciado,a.criterio.dica))})):(0,i.kq)("",!0),(0,i.Uk)(" "+(0,t.zw)(a.criterio.enunciado),1)]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.criterio.opcoesResposta,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t},[(0,i.Wm)(d,{modelValue:s.resposta,"onUpdate:modelValue":[o[1]||(o[1]=e=>s.resposta=e),o[2]||(o[2]=e=>n.enviarResposta(a.criterio))],label:e,val:e},null,8,["modelValue","label","val"])])))),128)),(0,i.Wm)(h,{modelValue:s.dica.visible,"onUpdate:modelValue":o[4]||(o[4]=e=>s.dica.visible=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i._)("div",c,(0,t.zw)(s.dica.title),1),(0,i.Uk)(" "+(0,t.zw)(s.dica.message),1)])),_:1}),(0,i.Wm)(p,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{flat:"",color:"primary",label:"Voltar",onClick:o[3]||(o[3]=e=>n.showDica(!1))})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const d={emits:["resposta"],props:{criterio:{type:Object,required:!0}},data(){return{dica:{visible:!1,title:"",message:""},resposta:""}},methods:{enviarResposta(e){const o={criterio:e.codigo,resposta:this.resposta};this.$emit("resposta",o)},showDica(e,o,a){this.dica.visible=e,this.dica.title=o,this.dica.message=a}}};var m=a(1639),p=a(4455),g=a(1480),h=a(7743),f=a(4458),b=a(3190),w=a(1821),v=a(9984),q=a.n(v);const Q=(0,m.Z)(d,[["render",u]]),k=Q;q()(d,"components",{QBtn:p.Z,QRadio:g.Z,QDialog:h.Z,QCard:f.Z,QCardSection:b.Z,QCardActions:w.Z});const _={data(){return{respostas:[],questionario:[],isLoading:!0,hasSubmitted:!1,resposta:"",nomeDimensao:""}},components:{QuestionarioComponent:k},beforeRouteUpdate(e,o,a){this.isLoading=!0,this.getQuestionario(e.params.numero),a()},mounted(){this.getQuestionario(this.$route.params.numero)},methods:{filtrarQuestionario(e){const o=localStorage.getItem("apo@usuario_edificacao"),a=localStorage.getItem("apo@usuario_cargo"),i=e.filter((e=>e.edificacoes.includes(o))).filter((e=>e.cargos.includes(a)));return i},getQuestionario(e){this.setNomeDimensao();const o=`/criterios/${e}`;n.api.get(o).then((e=>{this.questionario=this.filtrarQuestionario(e.data)})).catch((e=>{console.log(e)})).finally((()=>{this.isLoading=!1}))},prepareQuestionario(){const e=[];return this.questionario.forEach((o=>{const a=e.find((e=>e.categoria===o.categoria));a?a.perguntas.push(o):e.push({categoria:o.categoria,perguntas:[o]})})),e},addResposta(e){const o=this.respostas.findIndex((o=>o.criterio===e.criterio));-1===o?this.respostas.push(e):this.respostas[o]=e},enviarFormulario(){const e="/formularios",o=localStorage.getItem("apo@ambiente_id"),a={ambiente:o,respostas:this.respostas};n.api.post(e,a).then((()=>{this.hasSubmitted=!0,alert("Formulário salvo com sucesso!")})).catch((e=>{console.log(e),alert("Erro ao salvar formulário!")})).finally((()=>{this.isLoading=!1}))},irParaProximo(){n.api.get("/dimensoes").then((({data:e})=>{const{numero:o}=this.$route.params,a=e.filter((e=>"Gestão e Projeto"===e.grupo)),i=a.find((e=>e.numero>o));i&&this.$router.push(`/criterio/${i.numero}`)}))},irParaAnterior(){n.api.get("/dimensoes").then((({data:e})=>{const{numero:o}=this.$route.params,a=e.filter((e=>"Gestão e Projeto"===e.grupo)),i=a.findIndex((e=>e.numero===o)),t=a.slice(0,i),r=t[t.length-1];r&&this.$router.push(`/criterio/${r.numero}`)}))},setNomeDimensao(){n.api.get("/dimensoes").then((({data:e})=>{const{numero:o}=this.$route.params,a=e.find((e=>e.numero===o));a&&(this.nomeDimensao=a.nome)}))}}};var y=a(8289),W=a(926);const D=(0,m.Z)(_,[["render",s]]),C=D;q()(_,"components",{QCard:f.Z,QLinearProgress:y.Z,QCardSection:b.Z,QSeparator:W.Z,QCardActions:w.Z,QBtn:p.Z})}}]);